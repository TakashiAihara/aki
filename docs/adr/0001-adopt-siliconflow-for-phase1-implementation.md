# ADR-0001: Phase 1 実装のメインツールとして SiliconFlow を採用

## ステータス

Accepted

## 日付

2025-01-01

---

## コンテキスト

### 背景

本プロジェクトでは `docs/development/modern-ai.md` で定義したモダン AI 開発手法を採用している。Phase 1（実装フェーズ）では、以下の要件を満たす AI コーディングツールが必要:

- **日本語対応**: コメント・変数名・ドキュメントが日本語
- **高い性能**: Sonnet 4.5 / Qwen Coder 2.5 以上の品質
- **実質使い放題**: RPM 制限が緩く、大量のコード生成が可能
- **API 統合**: Continue.dev / OpenRouter 経由で統合可能

Phase 0 で固定した設計思想を Phase 1 で実装する際、生産性を最大化しつつ、学習利用のリスクを最小化する必要がある。

### フェーズ

- [x] Phase 0: 思考・設計
- [x] Phase 1: 実装
- [ ] Phase 2: AI レビュー
- [ ] Phase 3: 人間レビュー
- [ ] その他

---

## 決定内容

**Phase 1 実装のメインツールとして SiliconFlow（Qwen 2.5 Coder 32B）を採用する。**

詳細:

- **メインツール**: SiliconFlow (Qwen 2.5 Coder 32B)
  - 日本語コーディング最強
  - RPM 1,000+ で実質使い放題
  - Continue.dev / OpenRouter 経由で統合可能
- **サブツール1**: Cerebras (Qwen3-235B, Llama 3.3 70B)
  - 大量処理用（日100万トークン）
  - 最速推論（1,800 tok/s）
- **サブツール2**: OpenRouter ($5-10 投入推奨)
  - フェイルオーバー用
  - DeepSeek R1（reasoning 特化）

**運用方針**:
- Phase 0 で業務ロジックの思想は固定済み
- Phase 1 では Boilerplate / CRUD のみを実装
- 学習利用されても問題ないコードのみを生成

---

## 選択肢

### Option 1: SiliconFlow（採用）

**長所**:
- Qwen 2.5 Coder 32B は日本語コーディング性能が最高水準
- RPM 1,000+ で実質使い放題
- 新規ユーザーに $1 クレジット付与
- OpenRouter 連携で既存ツールと統合可能

**短所**:
- データが学習に使用される（中国系サービス）
- 無料枠が将来縮小される可能性
- サービスの信頼性・継続性が不透明

**採用理由**:
- Phase 0 で業務ロジックの思想は既に分離済み
- Phase 1 では Boilerplate のみ生成するため、学習利用リスクは許容範囲
- 日本語性能と無料枠のバランスが最良

---

### Option 2: Claude Code のみで全て実装

**長所**:
- データ学習されない（Anthropic ポリシー）
- 設計力・思考力が高い
- Phase 0 との一貫性

**短所**:
- 利用制限がある（Opus 4.5）
- Phase 1 の大量実装には不向き
- コストが高い

**不採用の理由**:
- Phase 1 の大量コード生成には制限が厳しすぎる
- Claude Code は Phase 0（設計）に専念させるべき

---

### Option 3: GitHub Copilot / Cursor

**長所**:
- IDE 統合が強力
- 補完性能が高い
- 多くの開発者が慣れている

**短所**:
- 有料プラン必須（月額 $10-20）
- 無料枠が非常に限定的
- モデル選択の自由度が低い

**不採用の理由**:
- 無料枠での運用が困難
- 複数モデル・プロバイダーの切り替えができない
- コスト面で SiliconFlow に劣る

---

### Option 4: Cerebras のみ

**長所**:
- 日100万トークンで最も寛大
- 最速推論（1,800 tok/s）
- データ学習されない

**短所**:
- 日本語性能が SiliconFlow / Qwen に劣る
- コーディング特化モデルではない

**不採用の理由**:
- 日本語コーディングでは Qwen 2.5 Coder に劣る
- ただし、サブツールとして併用する価値はある

---

## 結果

### 期待される影響

**ポジティブな影響**:
- Phase 1 実装の生産性が大幅に向上
- 日本語コメント・ドキュメントの品質向上
- 複数プロバイダーの抽象化により、ベンダーロックイン回避

**ネガティブな影響 / トレードオフ**:
- データが学習に使用されるリスク（ただし Phase 0 で業務思想は分離済み）
- 無料枠が将来縮小される可能性
- 中国系サービスへの依存（地政学的リスク）

### 実装への影響

- Continue.dev / OpenRouter の設定が必要
- LiteLLM でプロバイダー抽象化を実装
- フェイルオーバー設定（SiliconFlow → Cerebras → OpenRouter）

### モニタリング

この決定が正しかったかを検証する方法:

- **四半期ごとにレビュー**: 無料枠状況、モデル性能を確認
- **コード品質**: 日本語コメントの質、バグ発生率
- **生産性**: Phase 1 実装速度、開発者満足度

---

## 関連資料

### ドキュメント

- [docs/development/modern-ai.md](../development/modern-ai.md)
- [research.md](../../research.md) - 無料 LLM サービス調査

### Issue / PR

- Issue #7: AI プロンプト規約・ガイドラインの整備
- PR #5: Add modern AI development workflow documentation

### 使用した AI ツール

- Claude Code で設計検討・選択肢比較
- 調査は Gemini / ChatGPT / Claude による Web 検索を統合

---

## 備考

### 無料枠変動リスク対策

過去の事例（Together AI 廃止、Google Gemini 92% 削減）を踏まえ、以下の対策を実施:

1. **複数プロバイダー並行利用**: LiteLLM で抽象化
2. **フェイルオーバー設定**: SiliconFlow が使えなくなっても即座に切り替え
3. **定期レビュー**: 四半期ごとに無料枠状況を確認
4. **予算確保**: OpenRouter に $5-10/月 投入を想定

### 将来の見直しポイント

以下の状況になったら、この ADR を見直す:

- SiliconFlow の無料枠が大幅に縮小
- より優れた日本語コーディングモデルが登場
- データ学習ポリシーに変更があった場合

---

*作成者: Takashi Aihara*
*レビュー者: Claude Code*
